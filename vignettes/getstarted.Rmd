---
title: "Introduction to imgw"
author: "Czarnecki B., Głogowski A., Nowosad J."
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
library(imgw)
library(tidyr)
library(dplyr)
options(scipen=999)
```
Data is and will be always an element of the analysis for many people. When we start working with data first thing we do are:

-	Knowing the way of stored and accessibility.

-	Downloading the data,

-	Preparing to readable format (if the format is unclear)

The imgw package is a repository giving access to Polish databased of meteorological and hydrological parameters. The Autor’s offer  the tools which are:

-	Giving the easier access to public data stored in Institute of Meteorology and Water Management ([IMGW](https://dane.imgw.pl/))

-	Downloading the selected data for us

-	The data are converted from among eleven different forms of publicity depending on the interval and type of data

-	Description is available in two languages Polish and Engilsh 

## Functions 
imgw R package it consists of 9 usefull functions 4 to meteorological data 4 to hyrological and one to sounding meteo:

1. Meteorological data:

- `meteo_hourly()` Downloading meteorological the data with hourly interval 

- `meteo_daily()` Downloading meteorological the data with daily interval 

- `meteo_monthly()` Downloading meteorological the data with monthly interval 

- `meteo()` Downloading meteorological the data with interval the user want to choose 

2. Hydrological data: 

- `hydro_daily()` Downloading hyrological the data with daily interval

- `meteo_monthly()`  Downloading hyrological the data with monthly interval

- `meteo_annual()`  Downloading hyrological the data with annual interval

- `meteo()` Downloading hyrological the data with interval the user want to choose

3. Sounding meteo: 

- `meteo_sounding` -----------------------------------

Those functions have similar arguments allowing us to choose additional selections:

- `rank` argument of type the stations `"synop"`, `"climate"`, `"precip"` (**only meteo functions**)


- `year` vector of years (e.g., `1966:2000`)

- `status` logical argument TRUE or FALSE; if TRUE status of measurements will be erased (**only meteo functions**)

- `coords` logical argument TRUE or FALSE;  if TRUE coordinates are added to station

- `station` vector of stations can be the ID of stations (numeric) or name of the station (**CAPITAL LETTERS character**)

- `col_names` three types of column names possible: `"short"` - default, values with shorten names, `"full"` - full English description, `"polish"` - original names in the dataset

## Database
imgw is also supplied with few databases with can be helpful:

- `hydro_abberv`/`meteo_abberv` - Dictionary contains all original descriptions of parameters in both languages and the abbreviation. 
```{r abberv,echo=FALSE}
abbev=meteo_abbrev
abbev[3:8,]
```
- `hydro_stations`/`meteo_stations` - Dataset of almost all meteo / hydro stations contains ID  and latitude and longitude
```{r station,echo=FALSE}
station=meteo_stations
head(station)
```

## Application
We will show how to use our package and make simple preparation for spatial analysis with additional help of ([dyplr](https://cran.r-project.org/web/packages/dplyr/vignettes/dplyr.html)) and ([tidyr](https://cran.r-project.org/web/packages/tidyr/vignettes/tidy-data.html)) packages. We can see we download 10(**2001-2010**) years of monthly hydrological data without station selection adding the coordinates. 

```{r data }
h=hydro_monthly(year = 2001:2010,coords = T)
head(h)
```
`idex` depending on the value means `1` minimum `2` mean `3` maximum you can find information about this in `hydro_abber` dataset. Hydrologist often use the maximum value so we will filter the data `next` select `id` station, hydrological year(`hyy`), latitude`X` and longitude`Y`, `next` calculate the mean maximum value of flow on the stations in particular year with `dplyr` and then spread data by year using `tidyr` to get the run of annual mean of maximum flow in next columns.

```{r filering}
h%>%
  filter(idex==3)%>%
  select(id,X,Y,hyy,Q,mm)%>%
  group_by(hyy,id,X,Y)%>%
  summarise(annual_mean_Q=round(mean(Q,na.rm = T),2))%>%
  spread(hyy,annual_mean_Q)
```

That table can be easly exported to any spatial softwere with a changing annual maximum annual average water flow rate over the decade for Poland as a whole.
